
<div *ngIf="data == null">Waiting</div>
<div *ngIf="data != null && data.length == 0">Invalid information</div>
<div *ngIf="data != null && data.length != 0">
    <div class="header row">
        <div class="col-7 mr-0 pr-0">
            <div class="embed-responsive embed-responsive-16by9">
                <youtube-player videoId="{{data.youtube_video.key}}"></youtube-player>
            </div>
        </div>
        <div class="col-5 mr-0 pr-0">
            <h1>{{data.item_detail.title}}</h1>
            <p>{{data.item_detail.tagline}}</p>
            <p>{{data.item_detail.tagline}}</p>
            <p>{{data.item_detail.date|date:"yyyy"}}
                | &#9733;{{data.item_detail.vote_average}}
                | {{data.item_detail.runtime|timeHourMinute}}</p>
            <p>Genres: {{data.item_detail.genres}}</p>
            <p>Spoken languages: {{data.item_detail.spoken_language}}</p>

            <button type="button" class="btn btn-primary" (click)=addToWatchListBtnClickedHandle()>
                {{isItemAddedToWatchList ? 'Remove from WatchList' : 'Add to WatchList'}}
              </button>

            <div class="my-2">               
                <div class="alert-container alert mt-2" role="alert" 
                    [class.show]="isAlertShowed" 
                    [class.alert-primary]="isItemAddedToWatchList"
                    [class.alert-danger]="!isItemAddedToWatchList">
                    {{isItemAddedToWatchList ? 'Added to watch list' : 'Removed from WatchList.'}}
                    <!-- <button type="button" class="close" data-dismiss="alert" aria-label="Close"> -->
                    <button type="button" class="close" (click)="isAlertShowed=false;">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="description">
        <div>Description </div>
        {{data.item_detail.overview}}
    </div>
    <div class="Share">
        <div>Share </div>
        <div>
            <a class="share-button-twitter" href="https://twitter.com/intent/tweet?text={{twitterShareText}}"
                target="_blank" data-size="large">
                <img src="../../../assets/img/twitter-icon.png">
            </a>

            <a class="share-button-fb" href="https://www.facebook.com/sharer/sharer.php?u={{data.youtube_video.url}}"
                target="_blank">
                <img src="../../../assets/img/facebook-icon.png">
            </a>
        </div>
    </div>
    <div class="casts">
        <div>Full Cast and Crew</div>
        <div>
            <div class="d-flex flex-row flex-nowrap overflow-auto pl-2">
                <div *ngFor="let cast of casts;" 
                    class="col-2 card px-0 mx-2 my-2" 
                    style="color:black;"
                    (click)="openModal(modalContent, cast.id)">
                    <div class="card-header p-0">
                        <div class="aspect-ratio aspect-ratio--3x4 person_img_placeholder" style="width: 100%">
                            <img class="aspect-ratio--object" src="{{cast.profile_path}}"
                            onerror="this.style.display='none'">
                        </div>
                    </div>
                    <div class="card-body">
                        <h6 class="card-title">{{cast.name}}</h6>
                        <h6 class="card-title">AS</h6>
                        <p class="card-text">{{cast.character}}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="reviews">
        <div>
            <span>Reviews </span>
            <span style="font-weight: bold;">{{reviews.length}}</span>
        </div>
        <div *ngFor="let review of reviews;" class="card px-0 mx-2 my-2" style="color:black;">
            <div class="row" style="width: 100%;">
                <div class="col-2">
                    <div style="width: 80%">
                        <div class="aspect-ratio aspect-ratio--1x1 reivew_ava_img_placeholder">
                            <img class="aspect-ratio--object" 
                                src="{{review.avatar_path}}" 
                                style="background-color: white;" 
                                onerror="this.style.display='none'">
                        </div>
                    </div>
                </div>
                <div class="col-10">
                    <div>
                        <h6 class="card-title">
                            A review created by {{review.author}}
                            <button type="button" style="background-color: black; 
                                            color: white; 
                                            border-radius: 20px;
                                            border-color: black;">
                                &#9733; {{review.rating}}
                            </button>
                        </h6>
                    </div>
                    <div>
                        Written by {{review.author}} on {{review.create_at|date:"medium"}}
                    </div>
                    <div class="three-line-limited-content">
                        {{review.content}}
                    </div>
                    <div>
                        <a href="{{review.url}}" target="_blank" style="color: blue; text-decoration: underline;">
                            Read the rest
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div *ngIf="recommendations!=null && recommendations.length > 0" class="recommendations">
        <div>Recommended Movies</div>
        <app-horizontal-movie-list [movieItemSets]="recommendations">
        </app-horizontal-movie-list>
    </div>
    <div *ngIf="similarItems!=null && similarItems.length > 0" class="similars">
        <div>Similar Movies</div>
        <app-horizontal-movie-list [movieItemSets]="similarItems">
        </app-horizontal-movie-list>
    </div>
</div>

<ng-template #modalContent let-modal>
    <div *ngIf="selectedCast == null">No cast data</div>
    <div *ngIf="selectedCast != null">
        <div class="modal-header">
            <h4 class="modal-title" id="modal-basic-title">{{selectedCast.name}}</h4>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body" >
            <div style="overflow-y: hidden; height: calc(100vh - 15rem);">
                <div class="px-2" style="overflow-y: auto; height: 100%; overflow-x: hidden;">
                    
                    <div class="row">
                        <div class="col-3 mx-0">
                            <div class="aspect-ratio aspect-ratio--3x4 person_img_placeholder" style="width: 100%">
                                <img class="aspect-ratio--object" src="{{selectedCast.image_url}}">
                            </div>
                        </div>
                        <div class="col-8 ml-1">
                            <div>
                                <p *ngIf="selectedCast.birth_date != null">Birth: {{selectedCast.birth_date|date:'yyyy-MM-dd'}}</p>
                                <p *ngIf="selectedCast.birth_place != null">Birth Place: {{selectedCast.birth_place}}</p>
                                <p *ngIf="selectedCast.gender != null">Gender: {{selectedCast.gender|gender}}</p>
                                <p *ngIf="selectedCast.known_for != null">Known for: {{selectedCast.known_for}}</p>
                                <p *ngIf="selectedCast.other_names != null">Also Known as: {{selectedCast.other_names}}</p>
                            </div>
                            <div *ngIf="selectedCast.external_links != null">
                                <a *ngIf="selectedCast.external_links.imdb_id != null" 
                                    href="https://imdb.com/name/{{selectedCast.external_links.imdb_id}}" 
                                    target="_blank" class="share-button-imdb mr-1"
                                    ngbTooltip="Vist IMDB" placement="top" tooltipClass="custom-tooltip">
                                    <img src="../../../assets/img/imdb-icon.png">
                                </a>
                                <a *ngIf="selectedCast.external_links.insta_id != null" 
                                    href="https://instagram.com/{{selectedCast.external_links.insta_id}}" 
                                    target="_blank" class="share-button-insta mr-1"
                                    ngbTooltip="Vist Instagram" placement="top" tooltipClass="custom-tooltip">
                                    <img src="../../../assets/img/insta-icon.png">
                                </a>
                                <a *ngIf="selectedCast.external_links.fb_id != null" 
                                    href="https://facebook.com/{{selectedCast.external_links.fb_id}}" 
                                    target="_blank" class="share-button-fb mr-1"
                                    ngbTooltip="Vist Facebook" placement="top" tooltipClass="custom-tooltip">
                                    <img src="../../../assets/img/facebook-icon.png">
                                </a>
                                <a *ngIf="selectedCast.external_links.twiter_id != null" 
                                    href="https://twitter.com/{{selectedCast.external_links.twiter_id}}" 
                                    target="_blank" class="share-button-twitter mr-1"
                                    ngbTooltip="Vist Twitter" placement="top" tooltipClass="custom-tooltip">
                                    <img src="../../../assets/img/twitter-icon.png">
                                </a>                        
                            </div>
                        </div>
                    </div>
                    <div *ngIf="selectedCast.biography != null">
                        <diV>Biography</diV>
                        <div>{{selectedCast.biography}}</div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</ng-template>

